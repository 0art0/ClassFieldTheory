\chapter{Local Class Field Theory}

In this chapter we shall consider finite Galois extensions of local fields $l/k$.
We shall regard the multiplicative groups $l^\times$ as a representation of $\Gal(l/k)$, where
addition in the module is the operation which is usually written as multiplication.
We shall always write $H^\bullet(l/k,-)$ as an abbreviation of $H^\bullet(\Gal(l/k),-)$.
By the fundamental theorem of Galois theory we have
\[
	H^0(l/k,l^\times) = (l^\times)^G = l^\times.
\]
The norm map $N_{\Gal(l/k)} : l^\times \to k^\times$ defined in \ref{def:norm}
coincides with the usual norm map $N : l^\times \to k^\times$. This implies by
\ref{lem:Tate cohomology is cohomology or homology} the isomorphism
\[
	H^0_{\Tate}(l/k,l^\times) \cong k^\times / N(l^\times).
\]
We shall prove that $l^\times$ is a finite class formation and we shall construct a
fundamental class $\sigma \in H^2(l/k, l^\times)$.
This fundamental class gives a reciprocity isomorphism
\[
	\Gal(l/k)^{\ab}
	\cong
	k^\times / N(l^\times), \qquad
	g \mapsto \prod_{x \in \Gal(l/k)} \sigma(x,g).
\]
In the case that $l/k$ is unramified, the Galois group is generated by a Frobenius element $F_k$,
and the reciprocity map satisfies (for any uniformizer $\pi_k$ in $k$)
\[
	\reciprocity(F_k) = \pi_k N(l^\times).
\]
The construction of this reciprocity isomorphism and its properties are known as
\emph{local class field theory}.

Recall that $l^\times$ is a finite class formation if for all subgroups $S \subset \Gal(l/k)$
we have isomorphisms:
\[
	H^1(S,l^\times) \cong 0, \qquad H^2(S,l^\times) \cong \Z / |S| \Z.
\]
A more convenient to reformulation of this condition is the following.
For all intermediate fields $l / m / k$ we have isomorphisms:
\[
	H^1(l/m,l^\times) \cong 0, \qquad H^2(l/m,l^\times) \cong \Z / [l:m] \Z.
\]
The reason why this reformulation is so useful is because the base field $k$ is no longer involved,
so it's sufficient to prove the isomorphisms above for any Galois extension of local fields $l/m$
(i.e. without considering any subgroups of the Galois group).

The proof that $l^\times$ is a clas formation is achieved in the following steps:
\begin{enumerate}
	\item
	It is already proven in Mathlib that $H^1(l/k,l^\times) \cong 0$;
	this result is known as Hilbert's theorem 90.
	It remains to check that each $H^2(l/k,l^\times)$ is cyclic of order $[l:k]$, and to
	choose a generator.
	\item
	In the case that $l/k$ is cyclic, we can show that $|H^2(l/k,l^\times)| = [l:k]$ by
	Herbrand quotients. By inflation-restriction, this implies $|H^2(l/k,l^\times)| \le [l:k]$
	for all Galois extensions. Hence to prove that $l^\times$ is a class formation it's sufficient to
	find an element in $H^2(l/k,l^\times)$ of order $[l:k]$; such an element is a fundamental class.
	\item
	Suppose $l/k$ is unramified. In this case we have a decomposition:
	\[
		l ^\times \cong \cO_l^\times \oplus \Z.
	\]
	The subrepresentation $\cO_l^\times$ has trivial cohomology in this unramified case.
	Therefore for any intermediate field $l/m/k$ we have
	$H^\bullet(l/m,l^\times) \cong H^\bullet(l/m,\Z)$.
	Since $\Z$ is a finite class formation over a cycic group, it follows that $l^\times$ is a
	finite class formation.
	The cocycle $\sigma_1$ defined in \ref{lem:H2 cyclic Z} is a fundamental class,
	where we use the Frobenius element as a generator.
	\item
	Suppose $l/k$ is a Galois extension which is not necessarily unramified. To define the
	fundamental class in this case, we let $l'/k$ be the unramified extension with the same degree as
	$l/k$. We have already constructed the fundamental class $\sigma_1 \in H^2(l'/k, l'^\times)$.
	We let $\sigma_2$ be the inflation of $\sigma_1$ to $H^2(ll'/k, (ll')^\times)$.
	The extension $ll' / l$ is unramified, so we already have an explicit isomorphism
	$H^2(ll'/l, (ll')^\times) \cong \Z / [ll':l]$.
	Using this isomorphism, we can show that the restriction of $\sigma_2$
	to $H^2(ll'/l, (ll')^\times)$ is zero.
	Hence by inflation restriction there there is a unique $\sigma \in H^2(l/k, l^\times)$ whose
	inflation is $\sigma_2$.
	It is then easy to check that $\sigma$ is a fundamental class in $H^2(l/k,l^\times)$.
\end{enumerate}



\section{Notation and Preliminary results}

The following result (called Hilbert's theorem 90) is already in Mathlib.

\begin{theorem}\label{thm:hilbert 90}
	\mathlibok
	Let $l/k$ be a finite Galois extension of fields.
	Then $H^1(l/k, l^\times) \cong 0$.
\end{theorem}

\begin{theorem}\label{thm:additive field trivial}
	Let $l/k$ be a finite Galois extension of fields.
	Then there is an isomorphism of $\Gal(l/k)$-representations:
	\[
		l \cong \ind_1(k).
	\]
	In particular $l$ has trivial cohomology as a representation of $\Gal(l/k)$.
\end{theorem}

\begin{proof}
	Recall from Galois theory that there is a normal basis for $l$ over $k$, i.e. a basis of the
	form
	\[
		\{x \bullet b_0 : x \in \Gal(l/k)\}.
	\]
	Define a map $\ind_1(k) \cong l$ by
	\[
		\Phi (f : G \to_0 k) = \sum_{x \in \Gal(l/k)} f(x) \cdot x \bullet b_0.
	\]
	The map $\Phi$ is clearly a linear bijection;
	we check that it commutes with the Galois action:
	\[
		\Phi(g\bullet f)
		= \sum_x f(g^{-1}x) \cdot x b_0
		= \sum_x f(x) \cdot (gx) \bullet b_0
		= g \bullet \Phi(f).
	\]
\end{proof}






\section{The Herbrand quotient of \texorpdfstring{$l^{\times}$}{l*}}

In this section we'll prove that for a cyclic extension $l/k$ of local fields,
$h(l/k,l^\times) = [l:k]$.

\begin{lemma}
	\label{lem:exists additive trivial}
	\uses{lem:induced' trivial Tate}
	Let $l/k$ be a Galois extension of local fields and
	let $U$ be any neighbourhood of $0$ in $l$.
	There is a Galois-invariant compact open subgroup $L \subseteq U$
	which has trivial Tate cohomology.
\end{lemma}

\begin{proof}
	Let $P$ be the maximal ideal of $\cO_l$.
	Choose $n$ such that $P^n \subseteq U$.
	Choose a normal basis for $l$ over $k$ contained in $P^n$
	and let $L$ be the span of that basis over $\cO_k$.
	We therefore have an isomorphism of Galois modules $L \cong \ind_1(\cO_l)$,
	and induced representations have trivial Tate cohomology.
\end{proof}

\begin{lemma} \label{lem:herbrand compact open additive}
	\uses{lem:exists additive trivial,
		lem:herbrand finite,
		lem:herbrand ses}
	Suppose $l/k$ is a cyclic extension.
	Let $M \subset l$ be a compact open subrepresentation.
	Then $h(l/k,M)=1$.
\end{lemma}

\begin{proof}
	Choose $L \subseteq M$ as in lemma \ref{lem:exists additive trivial}.
	Since $L$ has finite index in $M$ we have $h(M) = h(L) = 1$.
\end{proof}


\begin{lemma}\label{lem:local isomorphism}
	There is a non-zero ideal $P^n \subset \cO_l$ such that the
	exponential and logarithm maps give inverse isomorphisms
	\[
		(1 + P^n, \times) \cong (P^n,+).
	\]
	This isomorphism commutes with the action of the Galois group.
\end{lemma}

\begin{proof}
	Choose $n$ large enough so that for all $r > 0$,
	\[
		rn - v_l(r!) \ge n, \qquad
		rn - v_l(r!) \stackrel{r \to \infty}\to \infty.
	\]
	Then $\exp(x)$ converges for all $x \in P^n$ to an element of $1 + P^n$ and
	$\log(1+x)$ converges to an element of $P^n$.
	Hence both $\exp(\log(1+x))$ and $\log(\exp(x))$ converge.
	The identities $\exp(\log(1+x))=1+x$ etc. follow by observing that they are true as
	an equations of power series
\end{proof}


\begin{lemma}\label{lem:herbrand local units}
	\uses{lem:local isomorphism,
		lem:herbrand compact open additive,
		lem:herbrand finite,
		lem:herbrand ses}
	If $l/k$ is a cyclic extension, then $h(l/k, \cO_l^\times) = 1$.
\end{lemma}

\begin{proof}
	Choose a subgroup $1+P^n$ as in the \ref{lem:local isomorphism}.
	Since $\cO_l^\times / (1+P^n)$ is finite we have
	\[
		h(\cO_l^\times) = h(1+P^n) = h(P^n).
	\]
	The right hand side is $1$ by \ref{lem:herbrand compact open additive}.
\end{proof}

\begin{lemma} \label{lem:herbrand local l*}
	\uses{lem:herbrand local units,
		lem:herbrand Z,
		lem:herbrand ses}
	If $l/k$ is a cyclic extension of local fields then $h(l/k, l^\times)= [l:k]$.
\end{lemma}

\begin{proof}
	We have a short exact sequence of representations
	\[
		0 \to \cO_l^\times \to l^\times \to \Z \to 0,
 	\]
	where the second map is the valuation.
	We've shown in \ref{lem:herbrand local units}, \ref{lem:herbrand Z}
	that $h(l/k,\cO^\times)=1$ and $h(l/k,\Z) = [l:k]$.
	Therefore $h(l/k,l^\times) = [l:k]$.
\end{proof}


\begin{lemma} \label{lem:local H2 l*}
	\uses{lem:herbrand local l*,
		thm:hilbert 90}
	If $l/k$ is a cyclic extension of local fields then $|H^2(l/k,l^\times)| = [l:k]$.
\end{lemma}

\begin{proof}
	The follows from \ref{lem:herbrand local l*} and \ref{thm:hilbert 90}.
\end{proof}


\section{An upper bound for \texorpdfstring{$H^2(l/k,l^\times)$}{$H^2(l/k,l*)$}}

\begin{theorem} \label{lem:local H2 upper bound}
	\uses{thm:hilbert 90,
		thm:inflation restriction sequence,
		lem:local H2 l*,
		cor:cohomology sub Sylow}
	Let $l/k$ be a Galois extenion of local fields.
	Then $|H^2(l/k,l^\times)| \le [l:k]$.
\end{theorem}

\begin{proof}
	Let $p$ be prime number dividing the degree $[l:k]$ and let $k_p$ be the fixed field
	of a Sylow $p$-subgroup $S_p$ of $\Gal(l/k)$.
	By \ref{cor:cohomology sub Sylow} it is sufficient to prove that
	$|H^2(l/k_p,l^\times)| \le [l:k_p]$, which is a special case of the theorem.
	In the special case, the Galois group is $S_p$, which is a solvable group.
	It is therefore sufficient to prove the theorem in the case that $\Gal(l/k)$ is solvable.
	(Note that $\Gal(l/k)$ is always solvable if $l/k$ is an extension of local fields,
	but we do not need to prve this.)

	We shall prove the theorem by induction on $k$, starting with $k=l$ and moving down in
	cyclic steps. Assume the result for $l/k$ and let $k_0$ be a subfield of $k$ with $k/k_0$ cyclic.
	It follows from \ref{thm:hilbert 90} that
	we have an inflation-restriction sequence in dimension 2:
	\[
		0 \to H^2(k/k_0, k^\times) \to H^2( l/k_0, l^\times) \to H^2(l/k, l^\times).
	\]
	The first term has order $[k : k_0]$ by \ref{lem:local H2 l*}, and the last term has
	order at most $[l:k]$ by the inductive hypothesis.
	Thereofore $H^2( l/k_0, l^\times)$ has order at most $[l:k] \times [k : k_0] = [l: k_0]$.
\end{proof}







\section{Fundamental classes in unramified extensions}

In this section we assume that $l/k$ is unramified.
In this case $\Gal(l/k)$ may be identified with $\Gal(\F_l / \F_k)$ where
$\F_l$ and $\F_k$ are the residue class fields of $l$ and $k$ respectively.
This group is cyclic and is generated by the Frobenius element $F_k$.
If we choose a uniformizer $\pi_k$ in $k$ (i.e. a generator for the maximal ideal in $\cO_k$)
then $\pi_k$ is also a uniformizer in $l$, so we may identify $\F_l$ with $\cO_l / \pi_k \cO_l$.

\begin{lemma} \label{lem:finite field trivial}
	The Galois modules $\F_l$ and $\F_l^\times$ have trivial cohomology.
\end{lemma}

\begin{proof}
	By periodicity, it's suffient to prove that $H^1$ and $H^2$ are trivial.
	Also, since $\F_l$ and $\F_l^\times$ are finite, they both have Herbrand quotient $1$,
	so it's enough to prove that $H^1$ is trivial.
	This follows from \ref{thm:hilbert 90} and \ref{thm:additive field trivial}.
\end{proof}


\begin{lemma} \label{lem:unramified additive trivial}
	\uses{thm:additive field trivial}
	If $l/k$ is unramified then there is a normal basis for $\cO_l$ over $\cO_k$.
	Hence there is an isomorphism of Galois representations $\cO_l \cong \ind_1 \cO_k$.
	In particular $\cO_l$ has trivial cohomology.
\end{lemma}

\begin{proof}
	By \ref{thm:additive field trivial}
	we may choose $x_0 \in \F_l$
	such that $\{g \bullet x_0 :g \in \Gal(l/k)\}$ is a normal basis.
	Let $y \in \cO_l$ be a lift of $x_0$.
	We claim that $\{g \bullet y\}$ is a normal basis	in $\cO_l$.
	It's sufficient to show that these vectors span $\cO_l$ over $\cO_k$.
	Choose any $z \in \cO_l$. By assumption we may solve the congruence
	\[
		z \equiv \sum \lambda_{g,0} g y \mod \pi_k.
		\qquad
		(\lambda_{g,0} \in \cO_k).
	\]
	Similarly we may solve the congruence
	\[
		(z - \sum \lambda_{g,0} g y) / \pi_k \equiv \sum \lambda_{g,1} g y \mod \pi_k.
		\qquad
		(\lambda_{g,1} \in \cO_k).
	\]
	This implies
	\[
		z \equiv \sum (\lambda_{g,0} + \lambda_{g,1} \pi_k) g y \mod \pi_k^2.
	\]
	etc.
	Proceeding in this way, we construct convergent series
	$\lambda_{g} = \sum \lambda_{g,r}\pi_k^r \in \cO_k$,
	such that $z = \sum_g \lambda_g y$.
\end{proof}




\begin{lemma}	\label{lem:unramified units trivial}
	\uses{lem:local isomorphism,
		lem:unramified additive trivial,
		lem:finite field trivial}
	If $l/k$ is unramified then $\cO_l^\times$ has trivial cohomology.
\end{lemma}

\begin{proof}
	Recall (\ref{lem:local isomorphism}) that for $n$ sufficiently large we have isomorphisms of
	Galois modules:
	\[
		1 + P^n \cong P^n \cong \cO_l,
	\]
	where the first map is the logarithm and the second map is multiplication by $\pi_k^{-n}$.
	Hence by \ref{lem:unramified additive trivial}, the multiplictive subgroup $1+P^n$ has trivial
	cohomology.
	The long exact sequence now gives isomorphisms
	\[
		H^r(l/k,\cO_l^\times) \cong H^r(l/k,\cO_l^\times / (1+P^n)).
	\]
	We'll prove by induction on $n$ that $\cO_l^\times / (1+P^n)$ has trivial cohomology.
	In the case $n = 1$ we have
	\[
		\cO_l^\times / (1+P) \cong \F_l^\times.
	\]
	In this case the result follows from \ref{lem:finite field trivial}.

	For the inductive step we note that there is a short exact sequence of Galois modules
	\[
		0 \to \F_l \to  \cO_l^\times / (1+P^{n+1})  \to\cO_l^\times / (1+P^n)  \to  0,
	\]
	where we have identified $P^n / P^{n+1}$ with $\F_l$.
	By the inductive hypothesis, we assume that $\cO_l^\times / (1+P^n)$ has tivial cohomology.
	By \ref{lem:finite field trivial} $\F_l$ has trivial cohomology.
	Hence by the long exact seqeunce, $\cO_l^\times / (1+P^{n+1})$ has trivial cohomology.
\end{proof}


\begin{corollary} \label{cor:cohomology unramified iso cohomology Z}
	Let $l/k$ be an unramified extension of local fields.
	Then there are isomorphisms
	\[
		H^\bullet_{\Tate}(l/k,l^\times) \cong H^\bullet_{\Tate} (l/k,\Z)
	\]
	defined by the valuation map $v : l^\times \to \Z$.
	The inverse map is defined by $n \mapsto \pi_k^n$, and does not depend on the choice of $\pi_k$.
\end{corollary}

\begin{proof}
	This follows from the long exact sequence using \ref{lem:unramified units trivial}.
\end{proof}


\begin{lemma} \label{lem:unrammified fundamental class}
	\uses{cor:cohomology unramified iso cohomology Z,
		lem:H2 cyclic Z}
	Let $l/k$ be an unramified cyclic extension of local fields.
	Then $H^2(l/k,l^\times)$ is cyclic of order $[l:k]$.
	It is generated by the cohomology class of the following cocycle
	\[
		\sigma_{l/k} (F_k^r, F_k^s) =
		\begin{cases}
			1 & r + s < [l:k], \\
			\pi_k & r + s \ge [l:k].
		\end{cases}
	\]
	Here $F_k$ is the Frobenius element generating $\Gal(l/k)$ and $r$ and $s$
	are chosen to be integers in the range $0 \le r,s <[l:k]$.
	It follows that $l / k$ is a finite class formation and $\sigma_{l/k}$ is a fundamental class.
\end{lemma}

\begin{proof}
	This follows from the previous result \ref{cor:cohomology unramified iso cohomology Z}
	together with the description of $H^2(l/k,\Z)$ in \ref{lem:H2 cyclic Z}.
\end{proof}


We therefore have a reciprocity isomorphism $\Gal(l/k) \cong k^\times / N(l^\times)$.

\begin{lemma}
	Let $l/k$ be an unramified extension of local fields and let $F_k$ be the Frobenius
	element in $\Gal(l/k)$. Let $\pi_k$ be a uniformizer of $k$. Then we have
	\[
		\reciprocity (F_k)= \pi_k,
	\]
	where the reciprocity map is defined by the fundamental class $\sigma_{l/k}$.
\end{lemma}

By \ref{lem:H2 cyclic Z} we have an isomorphim $H^2(l/k, l^\times) \cong \Z / [l:k]\cdot \Z$
defined by
\[
	\inv_{l/k}(\sigma) = \sum_{i=1}^{[l:k]} v_k(\sigma(F_k^i, F_k)).
\]
The class $\sigma_{l/k}$ maps to $1 \in \Z/n\Z$.







\begin{lemma}
	Let $m / l / k$ be an unramified tower of extensions of local fields
	Then the restriction to $m/l$ of $\sigma_{m/k}$ is $\sigma_{m/l}$.
\end{lemma}

\begin{proof}
	Up to cohomology, $\sigma_{l/k}$ does not depend on the choice of
	uniformizer, so we may assume $\pi_k=\pi_l$
	in our definitions of $\sigma_{m/k}$ and $\sigma_{m/l}$.
	We have $F_l = F_k^f$ where $f = [l:k]$.
	Hence
	\begin{align*}
		\sigma_{m/k}(F_l^r, F_l^s)
		&=
		\sigma_{m/k}(F_k^{fr}, F_k^{fs})\\
		&=
		\begin{cases}
			1 & fr + rs < [m:k] \\
			\pi_k & fr + fs \ge [m:k]
		\end{cases}\\
		&=
		\begin{cases}
			1 & r + s < [m:l] \\
			\pi_k & r + s \ge [m:l]
		\end{cases}\\
		&=\sigma_{m/l}(F_l^r,F_l^s).
	\end{align*}
\end{proof}






\section{Construction of fundamental classes}

Now let $l/k$ be a Galois extension of local fields of degree $n$ and let $l'$ be
the unramified extension of the same degree.
We shall let $m$ be the field generated by $l$ and $l'$.
Let $e$ and $f$ be the ramification index and inertia degree of $l/k$.
Then we have $[m:l] = e$, $v_l(\pi_k)= e$.
We shall write $F_l$ for the Frobenius element in $\Gal(l/m)$, which we regard as a subgroup
of $\Gal(m/k)$. We also write $F_k$ for the Frobenius element in $l'/k$.
With this notation we have:
\[
	F_l|l' = F_k^f.
\]
We have a class $\sigma_{l'/k} \in H^2(l'/k,l'^\times)$, and by inflation we can regard
$\sigma_{l'/k}$ as an element of $H^2(m/k,m^\times)$.
Let $\psi\in H^2(m/k,m^\times)$ be the inflation of $\sigma_{l/k}$.
Since the imflation map is injectove, $\psi$ has order exactly $[l:k]$.
We also have an inflation restriction sequence
\[
	0 \to H^2(l/k, l^\times) \to H^2(m/k , m^\times) \to H^2(m/l, m^\times)
\]
We'll calculate the restriction of $\psi$ to $H^2(m/l, m^\times)$.
Since $m/l$ is unramified, we have an isomorphism
\[
	\inv_{m/l} : H^2(m/l, m^\times) \cong \Z/ e.
\]
We have
\begin{align*}
	\inv_{m/l}(\psi)
	&=\sum_{i=0}^{e-1} v_l (\psi (F_l^i,F_l))\\
	&=\sum_{i=0}^{e-1} v_l (\sigma_{l'/k}((F_l|l')^i,F_l|l'))\\
	&=\sum_{i=0}^{e-1} v_l (\sigma_{l'/k}(F_k^{if},F_k^f))\\
	&=v_l (\pi_k) = e \equiv 0 \bmod [m:l].
\end{align*}
The first line above is the definition of $\inv_{m/l}$.
The second line is the definition of inflation of cocycles.
The calculation above shows that the image of $\psi$ in $H^2(m/l, m^\times)$ is $0$.
Therefore $\psi$ is the inflation of a unique element $\sigma_{l/k} \in H^2(l/k,l^\times)$.
Since the inflation map is injective $\sigma_{l/k}$ also has order $[l:k]$.
We have proved the following.

\begin{theorem} \label{H2 local cyclic}
	For every finite Galois extension $l/k$ of local fields,
	$H^2(l/k,l^\times)$ is a cyclic group of order $[l:k]$ generated by $\sigma_{l/k}$.
	In particular $l^\times$ is a class formation and $\sigma_{l/k}$ is a fundamental class.
	Corresponding the $\sigma_{l/k}$ there is a reciprocity isomorphism
	\[
		\Gal(l/k) \cong k^\times / N(l^\times).
	\]
\end{theorem}
